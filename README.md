# レコードコレクション管理アプリ

レコードコレクションを管理するためのWebアプリケーションです。SQLiteデータベースとExpressバックエンドを使用しています。

## 機能

- レコードのフィルタリング (アーティスト名、アルバム名、ジャンル、国、年代など)
- レコードのソート (アーティスト、アルバム名、発売年、ジャンル)
- レコードの詳細表示と編集
- レコードの追加
- レコードの削除
- 表示切替機能(テーブル表示とカード表示)

## セットアップ・起動手順

### 前提条件

- Node.js がインストールされていること

### 初回セットアップ

```bash
# 必要なパッケージをインストール
npm install

# データベースを初期化し、JSONファイルからデータをロード
npm run init-db
```

### 起動方法

```bash
# APIサーバーを起動
npm run server

# 別のターミナルでReact開発サーバーを起動
npm start
```

ブラウザで http://localhost:3000 を開くと、アプリケーションが表示されます。

## アプリの使い方

### レコード一覧

- デフォルトではテーブル表示でレコードが一覧表示されます
- 画面右上の切替ボタンでテーブル表示とカード表示を切り替えられます
- テーブルのカラムヘッダーをクリックするとソートが可能です

### レコードの詳細と編集

- 一覧でレコードをクリックすると詳細モーダルが開きます
- 詳細モーダルの右上にある「編集」ボタンで編集モードに切り替わります
- 編集画面で情報を変更し、「保存」ボタンで更新が可能です
- 評価欄は星アイコンで表示され、1〜5の評価が可能です

### レコードの追加

- 上部の「レコードを追加」ボタンで新規レコードを追加できます
- 必須項目はアーティスト名とアルバム名のみです

## ディレクトリ構造

```
record-collection-app/
  ├── public/             # 静的ファイル
  ├── server/             # バックエンドサーバー
  │    ├── server.js      # Express APIサーバー
  │    ├── init-db.js     # データベース初期化スクリプト
  │    └── records.db     # SQLiteデータベース（自動生成）
  ├── src/                # Reactアプリケーション
  │    ├── components/    # UIコンポーネント
  │    ├── utils/         # ユーティリティ関数
  │    ├── App.js         # メインアプリケーション
  │    └── index.js       # エントリーポイント
  ├── extracted_records.json  # 元のレコードデータ
  └── package.json        # 依存関係と実行スクリプト
```

## 技術スタック

- フロントエンド: React
- バックエンド: Express.js
- データベース: SQLite
- API通信: Axios

## データフロー

1. `init-db.js` スクリプトがJSONファイルからデータを読み取り、SQLiteデータベースに挿入
2. Expressサーバーがデータベースと通信してAPIを提供
3. Reactフロントエンドがユーザーインターフェースを提供し、APIからデータを取得

## データベース管理

### データベースのリセット

データベースをリセットして初期データをロードし直す場合は、以下のコマンドを実行します：

```bash
npm run init-db
```

### 注意点

- このコマンドを実行すると既存のデータベースが削除され、JSONデータから新しく作成されます
- データベースに加えた変更はすべて失われます

## バックエンドAPI

### エンドポイント

- `GET /api/records` - すべてのレコードを取得
- `GET /api/records/:id` - IDによるレコードの取得
- `POST /api/records` - 新しいレコードの追加
- `PUT /api/records/:id` - レコードの更新
- `DELETE /api/records/:id` - レコードの削除

## レコードデータの構造

レコードは以下のフィールドを持っています：

- `id` - レコードの一意識別子
- `artist` - アーティスト名
- `album_name` - アルバム名
- `release_year` - 発売年
- `genre` - ジャンル
- `country` - 国
- `size` - レコードのサイズ（インチ）
- `label` - レーベル
- `compilation` - コンピレーションかどうか（0または1）
- `star` - 評価（1〜5）
- `review` - レビュー
- `alphabet_artist` - アーティスト名（アルファベット表記）
- `music_link` - 試聴リンク
- `acquisition_date` - 取得日
- `storage_location` - 保管場所
- `catalog_number` - カタログ番号

## トラブルシューティング

- **APIサーバーに接続できない場合**: `npm run server` コマンドが実行されていることを確認してください
- **データベースが見つからない場合**: `npm run init-db` コマンドを実行してデータベースを初期化してください
- **変更が反映されない場合**: ブラウザをリロードするか、アプリケーションを再起動してください

## 今後の拡張予定

- ユーザー認証の追加
- 画像アップロード機能
- レコードのインポート/エクスポート機能
- 統計・分析機能

## 新機能の紹介

### レコード詳細の改善
- レコード詳細画面からレコードの編集が可能になりました
- アーティスト名の下にアルファベット表記を表示するようになりました

### レコード一覧の改善
- デフォルト表示がカードからテーブル表示に変更されました
- テーブル表示でソートしても各列の幅が変わらないようになりました

### 評価表示の改善
- 星による評価が常に5つ表示されるようになりました
- 未評価の場合は星が塗りつぶされていない状態で表示されます
