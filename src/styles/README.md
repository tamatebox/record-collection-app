# CSSリファクタリングガイド

このドキュメントでは、レコードコレクション管理アプリケーションのCSSリファクタリングについて説明します。

## はじめに

CSSコードの保守性と再利用性を高めるために、アプリケーションのスタイルを以下のように再構成しました：

1. 共通CSS変数の統合
2. 共通コンポーネントスタイルの抽出
3. 重複コードの削除
4. 大きなCSSファイルの分割
5. モジュール構造の改善

## ディレクトリ構造

```
src/
├── styles/                     # グローバルスタイル
│   ├── variables.css           # 共通CSS変数
│   ├── global.css              # グローバルスタイル（インポート含む）
│   ├── utils/                  # ユーティリティクラス
│   │   ├── spacing.css         # マージン、パディング
│   │   ├── typography.css      # フォント関連
│   │   └── animations.css      # アニメーション
│   └── components/             # 共通コンポーネント
│       ├── buttons.css         # ボタン
│       ├── forms.css           # フォーム
│       ├── modals.css          # モーダル
│       ├── tables.css          # テーブル
│       ├── cards.css           # カード
│       └── filters.css         # フィルター
└── components/
    └── [コンポーネント名]/
        └── styles/             # コンポーネント固有のスタイル
```

## 使用方法

### 基本的な使用法

アプリケーション全体で`global.css`を一度インポートするだけで、共通スタイルが適用されます：

```javascript
// index.js
import './styles/global.css';
```

### コンポーネント固有のスタイル

各コンポーネントは、必要に応じて独自のスタイルを持つことができます：

```javascript
// MyComponent.js
import './styles/MyComponent.css';
```

コンポーネント固有のCSSファイルでは、必要に応じて変数を使用できます：

```css
/* MyComponent.css */
@import '../../../styles/variables.css';

.my-component {
  color: var(--primary-color);
}
```

### CSS変数の使用

スタイル属性を直接指定する代わりに、CSS変数を使用してください：

```css
/* 良い例 */
.my-button {
  background-color: var(--primary-color);
  border-radius: var(--border-radius);
}

/* 避けるべき例 */
.my-button {
  background-color: #4a6cf7;
  border-radius: 8px;
}
```

## スタイルガイド

### 命名規則（BEMベース）

コンポーネントのスタイルには、BEM（Block Element Modifier）ライクな命名規則を使用します：

```css
/* ブロック：コンポーネントの基本単位 */
.record-card { }

/* 要素：ブロックの一部 */
.record-card__title { }
.record-card__image { }

/* 修飾子：状態や見た目のバリエーション */
.record-card--featured { }
.record-card--compact { }
```

ユーティリティクラスは短く直感的な名前を使います：
```css
.m-2 { margin: 0.5rem; }
.text-primary { color: var(--text-primary); }
```

### 優先順位とカスケード

1. スタイルの競合を避けるために、セレクタの詳細度を低く保ちます
2. `!important`の使用は極力避け、必要な場合はコメントで理由を明記します
3. スタイルの適用順序は以下の優先順位で行います：
   - リセット/ベーススタイル
   - 共通コンポーネント
   - レイアウト
   - ユーティリティクラス

### メディアクエリの使用

メディアクエリは以下のブレークポイントを標準とします：

```css
/* モバイル（ベースケース）: 0-767px */
/* デフォルトのスタイルはこちら */

/* タブレット: 768px-1023px */
@media (min-width: 768px) { }

/* デスクトップ: 1024px以上 */
@media (min-width: 1024px) { }

/* 大型ディスプレイ: 1440px以上 */
@media (min-width: 1440px) { }
```

コンポーネント固有のメディアクエリは、関連するコンポーネントのスタイルに直接含めます（ファイル分割せず）：

```css
/* record-list.css */
.record-list { /* 通常のスタイル */ }

@media (max-width: 768px) {
  .record-list { /* モバイル対応スタイル */ }
}
```

### ベストプラクティス

1. **CSS変数を最大限に活用する**
   - 色、サイズ、間隔などには常に変数を使用
   - 直接数値を書く代わりに意味のある変数名を使用

2. **コンポーネントの分離を意識する**
   - コンポーネントは他への依存を最小限に抑え、独立して機能するように設計
   - 外部の影響を受けないカプセル化されたスタイルを目指す

3. **カスケーディングを制限する**
   - セレクタのネストは3レベル以内に抑える
   - 長いセレクタチェーンを避ける

4. **コメントを効果的に使用する**
   - 複雑なスタイルには説明コメントを追加
   - ハック的な対応には理由と代替案をコメントで説明

5. **パフォーマンスを考慮する**
   - アニメーションには`transform`や`opacity`を優先的に使用
   - 過度に複雑なセレクタや`box-shadow`などの重い描画は避ける

6. **レスポンシブデザインはモバイルファースト**
   - 基本スタイルはモバイル向けに作成し、大きい画面サイズに拡張する
   - メディアクエリは`min-width`を基本に使用

### 新しいCSS機能の活用

1. **Grid Layout**
   - 複雑なレイアウトにはFlexboxよりもCSSグリッドを優先
   - 明示的な配置が必要な場合には`grid-template-areas`を活用

2. **Flexbox**
   - 1次元レイアウトや単純な整列には、Flexboxを使用

3. **カスタムプロパティ（CSS変数）**
   - 動的に変更する可能性のある値には、JavaScriptからアクセス可能なCSS変数を使用

4. **スムーズなトランジション**
   - 状態変化には適切なトランジションを設定し、ユーザー体験を向上
   - 大きな要素の変更には`will-change`プロパティを検討

## 利用可能なユーティリティクラス

### スペーシング

マージンとパディングのユーティリティクラスは、`m-{サイズ}`や`p-{サイズ}`の形式で利用できます：

```html
<div class="m-3 p-2">コンテンツ</div>
```

### タイポグラフィ

フォントサイズや色などのタイポグラフィ関連のクラス：

```html
<p class="text-lg font-medium text-primary">テキスト</p>
```

### アニメーション

アニメーションとトランジションのクラス：

```html
<div class="fade-in transition">アニメーション要素</div>
```

## コードレビューのチェックリスト

新規スタイルのレビュー時には、以下の点を確認してください：

1. CSS変数が適切に使用されているか
2. 命名規則が守られているか
3. 重複するスタイル定義がないか
4. レスポンシブ対応が適切か
5. 適切なコンポーネント分離がされているか
6. パフォーマンスに問題ないか

## 今後の展開

- スタイルのさらなるモジュール化
- Sassなどのプリプロセッサの導入検討
- 複数のテーマのサポート
- デザインシステムの構築
- アクセシビリティの向上

## 注意事項

- 既存のコンポーネントは徐々に新しいスタイル構造に移行してください
- import文のパスを適切に更新してください
- スタイルの変更を確認するために全ての画面をテストしてください